<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Brothers Shoes â€” Admin</title>

<script>
  if (sessionStorage.getItem("adminLogin") !== "true") {
    window.location.href = "login.html";
  }
</script>

<style>
  body {
    margin: 0;
    font-family: Arial, sans-serif;
    background: #0f0f0f;
    color: white;
  }

  .navbar {
    padding: 15px 40px;
    background: #0b0b0b;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .logo { color: #00e676; font-size: 24px; font-weight: bold; }

  .nav-links a {
    color: white;
    text-decoration: none;
    margin-left: 25px;
  }

  .admin-box {
    width: 450px;
    background: #1b1b1b;
    margin: 40px auto;
    padding: 30px;
    border-radius: 15px;
  }

  input, textarea, button {
    width: 100%;
    padding: 12px;
    margin-top: 10px;
    border-radius: 10px;
  }

  button {
    background: #00e676;
    border: none;
    font-weight: bold;
    cursor: pointer;
  }

  .logout { background: #ff4c4c; color: white; }
</style>
</head>

<body>

<nav class="navbar">
  <div class="logo">Brothers Shoes</div>
  <div class="nav-links">
    <a href="index.html">Home</a>
    <a href="products.html">Products</a>
    <a href="#" onclick="logout()">Logout</a>
  </div>
</nav>

<div class="admin-box">
  <h2>Admin Panel</h2>

  <input id="name" placeholder="Product Name">
  <input id="price" type="number" placeholder="Price">
  <textarea id="description" placeholder="Description"></textarea>
  <input type="file" id="imageInput">

  <button onclick="uploadProduct()">Upload Product</button>
  <button class="logout" onclick="logout()">Logout</button>
</div>

<script>
function logout() {
  sessionStorage.removeItem("adminLogin");
  window.location.href = "login.html";
}

const cloudName = "dwgtjjoj2";
const uploadPreset = "footwear_upload";

async function uploadImage(file) {
  const url = `https://api.cloudinary.com/v1_1/${cloudName}/image/upload`;
  const fd = new FormData();
  fd.append("file", file);
  fd.append("upload_preset", uploadPreset);

  const res = await fetch(url, { method: "POST", body: fd });
  const data = await res.json();
  return data.secure_url;
}

async function uploadProduct() {
  const name = document.getElementById("name").value;
  const price = document.getElementById("price").value;
  const desc = document.getElementById("description").value;
  const file = document.getElementById("imageInput").files[0];

  if (!file) return alert("Please select an image");

  const imageUrl = await uploadImage(file);

  await fetch(
    "https://script.google.com/macros/s/AKfycbxlvzwKMe4kLICwgKT00Vfe8H569MMNq-2wQ46GLWGd7WtAr3u3b8MAOFwTJpUzxWpT/exec",
    {
      method: "POST",
      mode: "no-cors",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ name, price, image: imageUrl, description: desc })
    }
  );

  alert("Product added!");
}
</script>

</body>
</html>
